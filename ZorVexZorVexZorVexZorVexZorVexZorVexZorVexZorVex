local player = game:GetService("Players").LocalPlayer
local runService = game:GetService("RunService")

local function new(class, parent, props)
    local obj = Instance.new(class)
    for k, v in pairs(props) do
        obj[k] = v
    end
    obj.Parent = parent
    return obj
end

local function hex(c) return Color3.fromHex(c) end

local gui, connections = nil, {}
local jumping, jumpCount, interval = false, 0, 1
local lastTick = 0

local function cleanup()
    jumping = false
    for _, c in connections do c:Disconnect() end
    table.clear(connections)
    if gui then gui:Destroy() end
end

local function buildUI()
    cleanup()

    gui = new("ScreenGui", player:WaitForChild("PlayerGui"), { Name = "OxireunGui" })

    local frame = new("Frame", gui, {
        Name = "MainFrame",
        Size = UDim2.new(0, 250, 0, 170),
        Position = UDim2.new(0.5, -125, 0.5, -85),
        BackgroundColor3 = hex("363636"),
        BorderSizePixel = 0,
        Active = true,
        Draggable = true
    })

    local title = new("TextLabel", frame, {
        Size = UDim2.new(1, 0, 0, 30),
        BackgroundTransparency = 1,
        Text = "By ZorVex",
        Font = Enum.Font.Gotham,
        TextSize = 16,
        TextColor3 = hex("FFFFFF")
    })

    local closeBtn = new("TextButton", frame, {
        Size = UDim2.new(0, 25, 0, 25),
        Position = UDim2.new(1, -28, 0, 2),
        BackgroundColor3 = hex("FFFFFF"),
        Text = "X",
        Font = Enum.Font.Gotham,
        TextSize = 16,
        TextColor3 = hex("363636"),
        BorderSizePixel = 0
    })

    local miniBtn = new("TextButton", frame, {
        Size = UDim2.new(0, 25, 0, 25),
        Position = UDim2.new(1, -56, 0, 2),
        BackgroundColor3 = hex("363636"),
        Text = "–",
        Font = Enum.Font.Gotham,
        TextSize = 16,
        TextColor3 = hex("FFFFFF"),
        BorderSizePixel = 0
    })

    local inputBox = new("TextBox", frame, {
        Size = UDim2.new(0.8, 0, 0, 26),
        Position = UDim2.new(0.1, 0, 0.24, 0),
        BackgroundColor3 = hex("959595"),
        TextColor3 = hex("363636"),
        Font = Enum.Font.Gotham,
        TextSize = 14,
        Text = "1",
        PlaceholderText = "tunda loncat (detik)",
        BorderSizePixel = 0
    })

    local toggleBtn = new("TextButton", frame, {
        Size = UDim2.new(0.8, 0, 0, 26),
        Position = UDim2.new(0.1, 0, 0.5, 0),
        BackgroundColor3 = hex("FFFFFF"),
        Text = "Start",
        Font = Enum.Font.Gotham,
        TextSize = 14,
        TextColor3 = hex("363636"),
        BorderSizePixel = 0
    })

    local counter = new("TextLabel", frame, {
        Size = UDim2.new(0.8, 0, 0, 26),
        Position = UDim2.new(0.1, 0, 0.74, 0),
        BackgroundTransparency = 1,
        Text = "Jumlah Lompatan : 0",
        Font = Enum.Font.Gotham,
        TextSize = 14,
        TextColor3 = hex("FFFFFF")
    })

    table.insert(connections, toggleBtn.MouseEnter:Connect(function()
        toggleBtn.BackgroundColor3 = hex("FFFFFF")
    end))
    table.insert(connections, toggleBtn.MouseLeave:Connect(function()
        toggleBtn.BackgroundColor3 = hex("FFFFFF")
    end))

    local function updateCounter() counter.Text = "Jumlah Lompatan : " .. jumpCount end

    local function toggle()
        if jumping then
            jumping = false
            toggleBtn.Text = "Start"
            return
        end

        local n = tonumber(inputBox.Text)
        if not n or n <= 0 then
            inputBox.Text = ""
            inputBox.PlaceholderText = "Invalid! >0"
            return
        end

        interval = n
        jumpCount = 0
        lastTick = 0
        updateCounter()
        jumping = true
        toggleBtn.Text = "Stop"
    end
    table.insert(connections, toggleBtn.MouseButton1Click:Connect(toggle))

    local minimized = false
    table.insert(connections, miniBtn.MouseButton1Click:Connect(function()
        minimized = not minimized
        if minimized then
            frame.Size = UDim2.new(0, 250, 0, 30)
            miniBtn.Text = "+"
            inputBox.Visible = false
            toggleBtn.Visible = false
            counter.Visible = false
        else
            frame.Size = UDim2.new(0, 250, 0, 170)
            miniBtn.Text = "–"
            inputBox.Visible = true
            toggleBtn.Visible = true
            counter.Visible = true
        end
    end))

    table.insert(connections, closeBtn.MouseButton1Click:Connect(cleanup))

    table.insert(connections, runService.Heartbeat:Connect(function(dt)
        if not jumping then return end
        lastTick += dt
        if lastTick >= interval then
            lastTick = 0
            local char = player.Character
            if char then
                local hum = char:FindFirstChildOfClass("Humanoid")
                if hum then
                    hum:ChangeState(Enum.HumanoidStateType.Jumping)
                    jumpCount += 1
                    updateCounter()
                end
            end
        end
    end))

    table.insert(connections, player.CharacterAdded:Connect(function()
        task.wait(0.3)
        buildUI()
    end))
end

buildUI()
